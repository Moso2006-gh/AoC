const input = `...#...........#..............#..................................................#...................#...................#..................
................................................................................................#..............#...........................#
..................................#...................#.......................................................................#.............
.......................#....................................................................#...............................................
........#........................................................#.......#..................................................................
..............................................#............#......................................................#.........................
...............#.....................#...............................#...........................#..........................#...............
....#...........................#................................................#.......................#..........................#.......
............................................................................................................................................
......................................................................................#......#..............................................
............#.......#.......................#.....#...........#.............................................................................
.........................#..................................................................................................................
................................................................................................................#...........................
..............................#.......#............................................................#.................#.................#....
............................................................................................#...............................................
.............................................................#.......#............#.......................#..............#.................#
.......#....................................................................................................................................
...............................................................................................................................#............
...............#............#......#...........................................#.......#....................................................
.........................................#................#.......#............................#.....#......................................
...................................................#...................................................................#....................
..............................................#.................................................................#..................#........
...................#.......................................................................#................................................
.#......................................................................#...................................................................
.......................#.....#............#................#......................#.............................................#...........
...............#....................#.......................................#................................#...........................#..
............................................................................................................................................
....................#................................................#...........................#.................#........................
...........#....................................#...................................#.......#.........#.....................................
..#...................................................#..................#.................................................................#
..................................#...............................#........................................................#................
..........................................................................................................#.................................
......................................................................#.................#.......#.....................#.....................
.......................................#..........#.........................................................................................
......#........................#..................................................#.........................................................
....................#.................................#................................................#.................................#..
...........#...................................................................................................#............#...............
...................................#.............................#.............#.................#.................................#........
.............................#..........................................................#.................#..........#......................
........................#................#..................#..................................................................#............
...................#.....................................................#.......................................#..........................
...................................................#.................................#...................................#..................
..........#.............................................................................................#...................................
......................................#.........................................#................#.....................................#....
.....................................................................#..................#...................#...............................
........................#..........................................................................................#........#...............
.#...............................................#..........................................#.........#....................................#
.............................#.............#..........#.....................................................................................
..............#...................#..............................................#........................#.................................
....................#.................................................#.....................................................................
.................................................................................................#................................#.........
....................................................#............................................................#..........................
................#..........................................#.......#.....................#...............................#...............#..
.....#................#.....................................................................................................................
#...............................................#............................................#.............#....................#...........
..........#.................#.............#............#....................................................................................
.....................................................................................#......................................................
..................#.................#....................................#......................#....................#......................
.............................................................#................................................#.............................
................................#.............#...................................#.......#.................................................
.....................................................................#.........................................................#............
...........#.........................................................................................#......................................
.....................#..............................#.........................#.....................................................#.......
..............................#.....#.......#.............................................................#.................................
.....#................................................................................#...........#.............#...........#..............#
................#...............................................#................................................................#..........
#...........................................................................................#........................#......................
..........................#.....#...........................................................................................................
.........................................................#................#.............................................................#...
......#............................................................................#........................................................
.........................................#.........................................................#..........#.............................
.....................#....................................................................#...............................#.................
..................................................................................................................................#.........
............#......................#.............................#.......#..................................................................
...........................................................#...................#.............#........#....................................#
#.......................................#........#..............................................................#...........................
.................#..................................................................#.......................................................
......................................................................................................................#.................#...
............................................................................................................................................
................................................................#.............................................#.............................
......#.........................#........#............................#.........................................................#...........
............................................................................................................................................
.....................................................#.............................................#........................................
.............#..........#.................................#........#........................................................................
...................#.........................................................#.................#............#........................#......
.............................................#.........................................#....................................................
............................................................................................................................................
.#.........#..........................................#....................................#................................................
.................#...................#...................................#...............................#.......................#..........
.......#..............#........#...................................................................................#........................
................................................................#....................#...........#....................................#.....
.........................................#.............................................................................#....................
...#.....................#......................#............................#..............................................................
...................................#..................................#......................#..............................#...............
............#......................................................................................#........................................
...............................#...........#................#....................#........................................................#.
..........................................................................................................#.................................
...........................#......................................#....................................................#............#.......
...#.....#...............................................#................#...................#..................#..........................
.............................................#................................................................................#.............
...............#........#...................................................................................................................
....................................#................#...............#.................#..........#.........................................
..........................................#........................................................................#........................
...........................#.....................#....................................................#.....................................
.................................#.............................................................................................#............
.........#.....................................................#...............................#............................................
.............................................#............................#.............................................#................#..
#..........................................................#........................#.......................................................
.............#.......#................................................#.......#...................#................#........................
..........................#................................................................................#................................
.......................................#.......................................................................................#............
......................................................................................#.....................................................
.......................#.....#......................#...............................................................................#......#
........#....................................#............#.............#...................................................#...............
.................#................................................#...........#........................................#....................
...........................................................................................#......#.........................................
.#....................................#.........#...........................................................................................
.......................................................#................................................#........#..............#...........
...........#................................................................................................................................
..................................................................................#.............#.....................#.....................
............................................................#..............................................#........................#.......
..#................................#.......#..................................#.............................................................
.......................#.............................................................#.....#...............................................#
.........#..........................................#..........................................................#............................
................#........................................#...........................................#................................#.....
...............................#........#.........................#.............#...........................................................
.............................................#....................................................................#.............#...........
....................................#........................#......................#...........#.......................#...................
...................#.............................#.......................................#..................................................
.............#..........................................................#...................................................................
........#..................................................................................................#................................
............................................................................................................................#............#..
#........................................#......................#..................................................#................#.......
.....................#.............#.....................#............................#.........#...........................................
.....#.....................#................................................................................................................
.........................................................................#..................................................................
.............#...............................................#....................#..................................#........#.............
........................#...........................#....................................................#..................................
........................................#........................#...............................#.............#..........#..........#......
..#.......................................................#...................#.............#...............................................`;

console.time("m");

const expandUniverse = (spaceMatrix) => {
    let newSpaceMatrix = [];
    spaceMatrix.forEach(row => {
        if(row.join('').split('#').length - 1 === 0) newSpaceMatrix.push(row.join("").replaceAll(".", "*").split(""));
        else newSpaceMatrix.push(row)
    });

    return newSpaceMatrix;
}

const transposeMatrix = (matrix => matrix[0].map((_, colIndex) => matrix.map(row => row[colIndex])))

let galaxiesPos = [];
const originalSpaceMatrix = input.split('\n').map((line, n) => line.split('')); 
const spaceMatrix = expandUniverse(transposeMatrix(expandUniverse(originalSpaceMatrix)));
spaceMatrix.forEach((row, n) => row.forEach((el, m) => {
    if(el === "#") galaxiesPos.push([n, m]);
}))

let sol = 0;
for (let i = 0; i < galaxiesPos.length; i++) {
    for(let e = 0; e < galaxiesPos.length; e++) {
        if(i === e) continue;

        const [verticalDisplacement, horizontalDisplacement] = [galaxiesPos[i][0] - galaxiesPos[e][0], galaxiesPos[i][1] - galaxiesPos[e][1]];
        let add = 0;

        for (let j = 0; j < Math.abs(verticalDisplacement); j++) {
            const sign = verticalDisplacement / Math.abs(verticalDisplacement);
            if(spaceMatrix[galaxiesPos[e][0] + j * (sign)][galaxiesPos[e][1]] === "*") add += 1000000 - 1;           
        }

        for (let j = 0; j < Math.abs(horizontalDisplacement); j++) {
            const sign = horizontalDisplacement / Math.abs(horizontalDisplacement);
            if(spaceMatrix[galaxiesPos[e][0]][galaxiesPos[e][1] + j * (sign)] === "*") add += 1000000 - 1;           
        }

        sol += Math.abs(galaxiesPos[i][0] - galaxiesPos[e][0]) + Math.abs(galaxiesPos[i][1] - galaxiesPos[e][1]) + add; 
    }
}

sol /= 2;

console.timeEnd("m");
console.log(sol);