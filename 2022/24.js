const input = `#.########################################################################################################################
#<>v^<vv<v<><.^v><<.>v><<^^<v..<>.v^>^v<^><vv>.>^v>^>>v^v>><^><><<^><^>.^>^<vv>v>^>>^<^v.^<^v<.><.v><<.^v^.^<v^v<<vv><<v>#
#<>.vv^^vv<^v.^><^v<>>.<<<.^<^<>v<v<<>v>^vv..<<.^>^>>>.<>>^.^<^<<<^<>vv>.<<><^>.^>.vv^^v..v^<v^<vv.^.>v<^<^.<>^^v>^>v^<^>#
#<<>v>v>v.^<><^><>^>.v<<>.^v.v<<v<^^v>v<^^<<>^>vv<vvv>^v^.<>>^^^^<><vvv<v^>^<vv.><..><^>^<<^><^.v>>^>>>v>v>>vv^v<<.<v^<^>#
#<^.vv><^>^^>v<.>^vvv>v^v>><v>><v<><^.>v^v<v<<<>v.^>>^>v>^.>><<<v.^^^v^.v>^^vv^<<.v^<^v.v<<>><><vv.vv<^..<vv^.^<>>>.<<^^>#
#<^<v<.>vvvvvv^>>.^v>.<<v^^^><^<^^<^>v><>>><>>vv^v><^>v>>v.^>>>v^v^^^.^^>^v<.v^>^^v<vv.<.<^v>vv^v>^v>>v<^^>>^^<><^>v<v>.>#
#<vvvv<<^<v^vvv<.^<vv>.>v<v><<^v>^^<^v<^>vv^.<^vvv<^>^^vv^.v.^^..><<>^.>...^<<^>^^<^vvv>.^<>>^.v^v.^<>v^<vvvv>^.<>v>><v<>#
#>.^>.vv^<^^<v><><<>>>vv>.<><^^<>>v><<>>v^vv.>^.>v^^<^<^.>>v<<<vv<<>>.<^<><.<<^v^><>.<>^<<.^>^v<>^^>><<>vv.v<>v^^>>>>>v><#
#<.^<>.>.^>v><.^<>>>^^<^v^>^<^.>^^^v.<>vv><>v^v^v^^<^>^<<.v^>^v.<>.<^.>v><>>.<<v<^>>v>>>.^<><v<vv.<^^>^v<<<^^.<v<^>v>v^<<#
#><^>.<<<^..>>>^>.>^<vv.<.v^><>>>^<.v<^^^><>v.>.v^v<^^v><^.^.><^^<>^^v<>><^<.v>><>>>>.>^v<^v^<<^v>>.v<^<>vv<>v>vv.^<<<v.<#
#>.^^<<><v.>^^>>.^>^v>^>..>>>^v^<v^^^>v>>v>>v.^<>vv><>.<>vvvvv.vvv..><>v.vv<^v^v>^>^vv^<v<.^>>.>v^><<v>^v^>>.>^v><<^^^<v<#
#.^<>>.v<>vv<vvv^^>vv><<.^>><^.v>>^v<.v^<^v^.<vvv^^>^^>^>>>.^.>vvv>>^^^^<^^v>^>v^<v><v^<><><<^v<<<><><<v^.vv><^vv^v<<vv<>#
#<..vvv>><.v<^><v.v^^^v>^^v<<^v<>^><^v>^vvv^<^v>>^>>^<v>^<<^v^v.^vv>^><^v<^v^v>vv>^<^^^v>^^^<.>^v.v^<^>>^>^^^^^^vv<.v^^><#
#<v><<v>>^v<>>v^^v<^v<<><<^><^<<^^>.<.^v>^>>v<>^><.^<<<.>^^v^vvv><<^>>^^<^^<><v.^v<<^..v^.<v>>^v.>^<^^v<<vvv^v<^<<<<<v>^>#
#<v<<v^<^<^^v^vv<<<.>v<<><<^v^.^>><.v<^<v<^<<<<.<v^^vvv^>^^^>.><<><><<<^>v.>>>vv<.<v.><>^v^>^^^^.>v^<>.v>^.<v>v<^.v>vv<>>#
#>v<v..<^v^<<<>><>>^<^v>>v>v^>vv^v<^.vv^vv>v<<<vv.v^.>^v><<v<vv>>^<.>vvv...v<^><>>.^v>v<^^>v^v<<>v>.^>><<<><<v^<v^.^v^>v>#
#<<>^v>v>v<<<vvvv^^>v^..>..>^<>^>>><><<><v><^vv.>^v>v^v<<<vv><<.>><<<<<.<<<>^><v><vv^^v>^>>>><.^.^^>v<^<^>>.^>>^v.<>^>v>>#
#>v<<<>^^>..^>>v.v^<><^>^^<<vv<<>>^<<>v^.<^><.v>>vv^v<v<^^v..>>^^^>^v>^v^^v^>^.<^>>>v^<><v>^.<>>^^<vv>>>^><^>>.<<>>v>vv<>#
#<^^^..>>><>v>v>.>^.<.vv.vv<>v^vv<<^^>>v<^^<vv><^>><v>>>^^^><^^<.<^^>v>^^><v<vv^>vvv<^<..^>>>^v^v^^v>^^^.<.>v<^v><><>^^.>#
#>^^>^^^^.<<.v^.><v<^^.<<<.><<><>.<<<^^><.>>..<>v^^^>^v<^>>.>v><^^vvv^>>^<v>v><^<>^<>>^^v>^.v>v<<>>>^v^vv<<<^..<>^><>>^>.#
#.^<<<^^vv<.>v<.<>.>v.^..^^.>.vv.v>^>v.^.v<>v>>^^<^<^^^>>^>vvv.<^>><^>><^^>^>..^><.<v>.<^>^^v^v.>v<v^^><<>>vv^vv><v<>v^<>#
#<vvv><<>v<^<^.>..^<.<v^v^v>.^<^vv^v>v<vvv<>><>vv.vvv<^><^^>><>vv>^^^><>^<^^><^>.>v<>^.vv<v<<v^^>v<v.^^^><>^<v^<>.>.^^v^>#
#>v.^>..^>v>v>^^<^v>..>..^<.^..>>v<>.<>.<v>>>vv^<<>>>v<v^v^^vv<^vvvv<^v<^v<^^>>v>v><v><<v><v><^v<v>^>^^<>v.v<<^<.<><<<>.>#
#>>v><..^^^.<v<^^<v<><<<<<^^^<>^^v^.>vv<v><<>>^^^<v^vv^v^<>...>^.<v><<^^v^..><>vv>v^>^v>.vv<v<^.<<<v^<^v^<<v^.<.^<.>v^<><#
#>^v<..<>>v^v>v>v^v^<^<^^<..><v>^^>><<><>.^v.v<^>^<v><.^vv^.>v^>^v>^^v^>v<v^...><<<>><>>>^<vv<<^^^.<^vv^^^.v<vv<<<>>^><^<#
#>><<v<>>>vv>>^^^v^^^>^>><v<>><^vv><>>>^.v^>^>^vv<>>..^v.^^^vvvv<><^><^v>vv<<^vv>^>v..<><.>^^^v.v>vvvv>>>><<vv<>.<v^<vv>>#
########################################################################################################################.#`

//0 -> Right
//1 -> Down
//2 -> Left
//3 -> Up

let Blizards = [];
const margins = {
    y: [100, 0],
    x: [100, 0]
}
input.split('\n').forEach((line, m) => {
    Blizards.push([]);
    line.split('').forEach((chr, n) => {
        switch(chr) {
            case '>':
                Blizards[Blizards.length - 1].push([n, 0])
                break;
            case 'v':
                Blizards[Blizards.length - 1].push([n, 1])
                break;
            case '<':
                Blizards[Blizards.length - 1].push([n, 2])
                break;
            case '^':
                Blizards[Blizards.length - 1].push([n, 3]);
                break;
            
            case '#':
                if(margins.y[0] > m) margins.y[0] = m;
                if(margins.y[1] < m) margins.y[1] = m;
                if(margins.x[0] > n) margins.x[0] = n;
                if(margins.x[1] < n) margins.x[1] = n;
                break;

            default:
                break;
        }
    })
})

let poss = [[0, 1]];

let keepMove = true;
let state = 0;
let i = 0;

while(keepMove) {
    i++;
    console.log(i);

    let newBlizards = [];
    for (let w = 0; w <= margins.y[1]; w++) newBlizards.push([]);
    Blizards.forEach((BlizardRow, m) => {
        BlizardRow.forEach(Blizard => {
            const dir = Blizard[1];
    
            switch(dir) {
                case 0:
                    if(Blizard[0] + 1 !== margins.x[1]) newBlizards[m].push([Blizard[0] + 1, Blizard[1]]);
                    else newBlizards[m].push([margins.x[0] + 1, Blizard[1]])
                    break;
                case 1:
                    if(m + 1 !== margins.y[1]) newBlizards[m + 1].push(Blizard);
                    else newBlizards[margins.y[0] + 1].push(Blizard);
                    break;
                case 2:
                    if(Blizard[0] - 1 !== margins.x[0]) newBlizards[m].push([Blizard[0] - 1, Blizard[1]])
                    else newBlizards[m].push([margins.x[1] - 1, Blizard[1]])
                    break;
                case 3:
                    if(m - 1 !== margins.y[0]) newBlizards[m - 1].push(Blizard);
                    else newBlizards[margins.y[1] - 1].push(Blizard);
                    break;
            }
        })
    })
    Blizards = [...newBlizards]


    let newPos = [];
    for (let e = 0; e < poss.length; e++) {
        const pos = poss[e]
        if(state === 0) {
            if(pos.toString() === [margins.y[1] - 1, margins.x[1] - 1].toString()) {
                newPos = [[margins.y[1], margins.x[1] - 1]];
                state++;
                break;
            }
        }
        else if (state === 1) {
            if(pos.toString() === [margins.y[0] + 1, margins.x[0] + 1].toString()) {
                newPos = [[margins.y[0], margins.x[0] + 1]];
                state++;
                break;
            }
        }
        else if (state === 2) {
            if(pos.toString() === [margins.y[1] - 1, margins.x[1] - 1].toString()) {
                keepMove = false;
                break;
            }
        }

        if(Blizards[pos[0]].find(blizard => blizard[0] === pos[1]) === undefined) { 
            if(newPos.find(npos => npos.toString() === pos.toString()) === undefined) newPos.push(pos);
        }

        if(pos[1] + 1 < margins.x[1] && pos[0] !== margins.y[0] && pos[0] !== margins.y[1]) {
            if(Blizards[pos[0]].find(blizard => blizard[0] ===  pos[1] + 1) === undefined) {
                if(newPos.find(npos => npos.toString() === [pos[0], pos[1] + 1].toString()) === undefined) newPos.push([pos[0], pos[1] + 1])
            }
        }
        
        if(pos[0] + 1 < margins.y[1]) {
            if(Blizards[pos[0] + 1].find(blizard =>blizard[0] ===  pos[1]) === undefined) {
                if(newPos.find(npos => npos.toString() === [pos[0] + 1, pos[1]].toString()) === undefined) newPos.push([pos[0] + 1, pos[1]])
            }
        }

        if(pos[1] - 1 > margins.x[0] && pos[0] !== margins.y[0] && pos[0] !== margins.y[1]) {
            if(Blizards[pos[0]].find(blizard => blizard[0] ===  pos[1] - 1) === undefined) { 
                if(newPos.find(npos => npos.toString() === [pos[0], pos[1] - 1].toString()) === undefined) newPos.push([pos[0], pos[1] - 1])
            }
        }

        if(pos[0] - 1 > margins.y[0]) {
            if(Blizards[pos[0] - 1].find(blizard => blizard[0] === pos[1]) === undefined) { 
                if(newPos.find(npos => npos.toString() === [pos[0] - 1, pos[1]].toString()) === undefined) newPos.push([pos[0] - 1, pos[1]])
            }
        }
    }
    poss = [...newPos]
    
}

console.log(i);